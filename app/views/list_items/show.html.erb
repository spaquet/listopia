<!-- app/views/list_items/show.html.erb -->
<div class="space-y-6">
  <!-- Back Link -->
  <div class="flex items-center space-x-2 text-sm">
    <%= link_to "â† Back to #{@list.title}", list_path(@list), class: "text-blue-600 hover:text-blue-700 font-medium" %>
  </div>
  <!-- Main Content: Two Column Layout -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Left Column: Item Details (2/3 width on large screens) -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Item Header Card -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <!-- Title and Status -->
        <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-4">
          <h1 class="text-3xl font-bold text-gray-900"><%= @list_item.title %></h1>
          <div class="flex gap-2">
            <!-- Status Badge -->
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium <%= 
              case @list_item.status
              when 'pending'
                'bg-gray-100 text-gray-800'
              when 'in_progress'
                'bg-yellow-100 text-yellow-800'
              when 'completed'
                'bg-green-100 text-green-800'
              end %>">
              <%= @list_item.status.humanize %>
            </span>
            <!-- Priority Badge -->
            <%= priority_badge(@list_item) %>
          </div>
        </div>
        <!-- Description -->
        <% if @list_item.description.present? %>
          <div class="prose prose-sm max-w-none mb-6">
            <%= simple_format(h(@list_item.description)) %>
          </div>
        <% end %>
        <!-- Item Type -->
        <% if @list_item.item_type.present? %>
          <div class="mb-4">
            <span class="inline-block px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded">
              <%= @list_item.item_type.humanize %>
            </span>
          </div>
        <% end %>
        <!-- Actions -->
        <% if current_user && can_edit_list?(@list, current_user) %>
          <div class="flex gap-2 mt-6 pt-6 border-t border-gray-200">
            <%= link_to "Edit", edit_list_list_item_path(@list, @list_item),
                        class: "inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors" %>
            <%= button_to "Delete", list_list_item_path(@list, @list_item),
                          method: :delete,
                          data: { turbo_confirm: "Are you sure?" },
                          class: "inline-flex items-center px-4 py-2 border border-red-300 rounded-lg text-sm font-medium text-red-700 bg-white hover:bg-red-50 transition-colors" %>
          </div>
        <% end %>
      </div>
      <!-- Item Details Card -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Details</h2>
        <div class="grid grid-cols-2 gap-6">
          <!-- Assigned To -->
          <div>
            <h3 class="text-sm font-semibold text-gray-600 mb-2">Assigned To</h3>
            <% if @list_item.assigned_user.present? %>
              <p class="text-gray-900"><%= @list_item.assigned_user.name %></p>
            <% else %>
              <p class="text-gray-500 italic">Unassigned</p>
            <% end %>
          </div>
          <!-- Priority -->
          <div>
            <h3 class="text-sm font-semibold text-gray-600 mb-2">Priority</h3>
            <p class="text-gray-900"><%= @list_item.priority.humanize %></p>
          </div>
          <!-- Status -->
          <div>
            <h3 class="text-sm font-semibold text-gray-600 mb-2">Status</h3>
            <p class="text-gray-900"><%= @list_item.status.humanize %></p>
          </div>
          <!-- Due Date -->
          <div>
            <h3 class="text-sm font-semibold text-gray-600 mb-2">Due Date</h3>
            <% if @list_item.due_date.present? %>
              <span class="text-gray-900">
                <%= @list_item.due_date.strftime('%B %d, %Y') %>
              </span>
              <% if @list_item.overdue? %>
                <span class="text-red-600 text-sm font-medium">(Overdue)</span>
              <% end %>
            <% else %>
              <p class="text-gray-500 italic">No due date</p>
            <% end %>
          </div>
        </div>
        <!-- Additional Fields -->
        <div class="grid grid-cols-2 gap-6 mt-6">
          <!-- Estimated Duration -->
          <% if @list_item.estimated_duration.present? || @list_item.duration_days.present? %>
            <div>
              <h3 class="text-sm font-semibold text-gray-900 mb-2">Duration</h3>
              <p class="text-gray-700">
                <% if @list_item.duration_days.present? %>
                  <%= @list_item.duration_days %> day<%= 's' if @list_item.duration_days != 1 %>
                <% elsif @list_item.estimated_duration.present? %>
                  <%= @list_item.estimated_duration %>
                <% end %>
              </p>
            </div>
          <% end %>
          <!-- URL -->
          <% if @list_item.url.present? %>
            <div>
              <h3 class="text-sm font-semibold text-gray-900 mb-2">Link</h3>
              <%= link_to @list_item.url, @list_item.url, target: '_blank', rel: 'noopener noreferrer',
                          class: "text-blue-600 hover:text-blue-700 hover:underline truncate" %>
            </div>
          <% end %>
        </div>
        <!-- Metadata -->
        <div class="mt-6 pt-6 border-t border-gray-200 text-xs text-gray-500">
          <div class="flex items-center justify-between">
            <div>
              <p>Created <%= time_ago_in_words(@list_item.created_at) %> ago</p>
              <p>Updated <%= time_ago_in_words(@list_item.updated_at) %> ago</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Right Column: Comments (1/3 width on large screens) -->
    <div class="lg:col-span-1">
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 flex flex-col h-full">
        <%= render "comments/comments", commentable: @list_item %>
      </div>
    </div>
  </div>
</div>