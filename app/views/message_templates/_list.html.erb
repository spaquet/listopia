<!-- app/views/message_templates/_list.html.erb
     Renders list results from tool calls (users, teams, organizations, lists, etc.)
-->

<div class="tool-result bg-gray-50 rounded-lg border border-gray-200 overflow-hidden">
  <!-- Header -->
  <div class="px-4 py-3 bg-gray-100 border-b border-gray-200">
    <h3 class="text-sm font-semibold text-gray-900">
      <%= message.content %>
    </h3>
  </div>

  <!-- Results -->
  <div class="p-4">
    <% if data[:items].present? && data[:items].any? %>
      <div class="space-y-2 max-h-96 overflow-y-auto">
        <% data[:items].each do |item| %>
          <div class="p-2 bg-white rounded border border-gray-200 hover:bg-gray-50 transition">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <p class="font-medium text-sm text-gray-900">
                  <%= item[:name] || item[:title] || item[:id] %>
                </p>
                <% if item[:email].present? %>
                  <p class="text-xs text-gray-500"><%= item[:email] %></p>
                <% end %>
                <% if item[:description].present? %>
                  <p class="text-xs text-gray-600 mt-1"><%= truncate(item[:description], length: 100) %></p>
                <% end %>
                <% if item[:status].present? || item[:role].present? %>
                  <div class="flex gap-2 mt-2">
                    <% if item[:status].present? %>
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium <%= status_badge_class(item[:status]) %>">
                        <%= item[:status].humanize %>
                      </span>
                    <% end %>
                    <% if item[:role].present? %>
                      <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                        <%= item[:role].humanize %>
                      </span>
                    <% end %>
                  </div>
                <% end %>
              </div>
              <% if item[:url].present? %>
                <a href="<%= item[:url] %>" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                  View â†’
                </a>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Pagination info -->
      <div class="mt-3 pt-3 border-t border-gray-200">
        <p class="text-xs text-gray-600">
          Showing <%= data[:items].length %> of <%= data[:total_count] %> <%= data[:resource_type].pluralize.downcase %>
          <% if data[:page].present? && data[:page] > 1 %>
            (page <%= data[:page] %>)
          <% end %>
        </p>
      </div>
    <% else %>
      <p class="text-sm text-gray-600">No <%= data[:resource_type].pluralize.downcase %> found.</p>
    <% end %>
  </div>

  <!-- Hidden tool result data for JavaScript -->
  <div data-tool-result="<%= data.to_json %>"></div>
</div>

<style>
  <% def status_badge_class(status) %>
    <% case status %>
    <% when 'active', 'pending' %>
      bg-green-100 text-green-800
    <% when 'suspended', 'archived' %>
      bg-red-100 text-red-800
    <% when 'inactive' %>
      bg-gray-100 text-gray-800
    <% else %>
      bg-gray-100 text-gray-800
    <% end %>
  <% end %>
</style>
