<!-- app/views/lists/_kanban_list_card.html.erb -->
<div class="group relative bg-white rounded-lg border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all duration-200 p-4">
  <!-- Quick Actions (on hover) -->
  <% if current_user && can_edit_list?(list, current_user) %>
    <div class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center space-x-1">
      <!-- Edit -->
      <%= link_to edit_list_path(list),
                  class: "p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-all",
                  title: "Edit" do %>
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
        </svg>
      <% end %>

      <!-- Delete -->
      <% if can_delete_list?(list, current_user) %>
        <%= button_to list_path(list),
                      method: :delete,
                      data: { turbo_confirm: "Delete this list?" },
                      class: "p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-all",
                      title: "Delete" do %>
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
          </svg>
        <% end %>
      <% end %>
    </div>
  <% end %>

  <!-- List Type Badge -->
  <div class="mb-2">
    <% if list.list_type == 'professional' %>
      <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
        Professional
      </span>
    <% elsif list.list_type == 'personal' %>
      <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
        Personal
      </span>
    <% end %>
  </div>

  <!-- Title & Link -->
  <h4 class="font-semibold text-sm text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors">
    <%= link_to list.title, list_path(list), class: "hover:underline" %>
  </h4>

  <!-- Description (if present) -->
  <% if list.description.present? %>
    <p class="text-xs text-gray-600 mb-3 line-clamp-1">
      <%= list.description %>
    </p>
  <% end %>

  <!-- Stats Row -->
  <div class="flex items-center justify-between text-xs text-gray-500 mb-3">
    <div class="flex items-center space-x-2">
      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
      </svg>
      <span><%= pluralize(list.list_items_count, 'item') %></span>
    </div>

    <!-- Completion percentage -->
    <% if list.list_items_count > 0 %>
      <span class="font-medium text-gray-700">
        <%= ((list.list_items.status_completed.count.to_f / list.list_items_count) * 100).round %>%
      </span>
    <% end %>
  </div>

  <!-- Progress Bar -->
  <% if list.list_items_count > 0 %>
    <div class="h-1.5 bg-gray-200 rounded-full overflow-hidden mb-3">
      <div class="h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all duration-300"
           style="width: <%= ((list.list_items.status_completed.count.to_f / list.list_items_count) * 100).round %>%"></div>
    </div>
  <% end %>

  <!-- Owner Info -->
  <div class="flex items-center text-xs text-gray-500 pt-2 border-t border-gray-100">
    <div class="w-4 h-4 rounded-full bg-gradient-to-br from-blue-400 to-purple-600 text-white flex items-center justify-center text-xs font-bold mr-1.5 flex-shrink-0">
      <%= list.owner.email[0].upcase %>
    </div>
    <span class="truncate"><%= list.owner.email.split('@')[0] %></span>
  </div>

  <!-- View Button -->
  <div class="mt-3">
    <%= link_to list_path(list),
                class: "w-full flex items-center justify-center px-3 py-1.5 text-xs font-medium text-blue-600 border border-blue-300 rounded-md hover:bg-blue-50 transition-colors" do %>
      <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
      </svg>
      View List
    <% end %>
  </div>
</div>
