<!-- app/views/lists/kanban.html.erb -->
<div class="space-y-6">
  <!-- Header Section -->
  <div id="list-header-<%= @list.id %>">
    <%= render "lists/header", list: @list %>
  </div>

  <!-- Kanban Board -->
<div class="overflow-x-auto pb-6" data-controller="kanban">
  <div class="flex gap-6 min-w-min">
    <% @board_columns.each do |column| %>
      <div class="flex flex-col w-96 flex-shrink-0 bg-gray-50 rounded-lg border border-gray-200">
        <!-- Column Header -->
        <div class="px-5 py-4 border-b border-gray-200 bg-white rounded-t-lg">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-2">
              <h3 class="text-sm font-semibold text-gray-900"><%= column.name %></h3>
              <span id="column-count-<%= column.id %>" class="column-count inline-flex items-center justify-center px-2 py-1 text-xs font-medium text-gray-600 bg-gray-100 rounded-full" data-column-id="<%= column.id %>">
                <%= column.list_items.count %>
              </span>
            </div>
          </div>
        </div>
        <!-- Column Items -->
        <div class="flex-1 overflow-y-auto p-4 space-y-3"
               id="column_<%= column.id %>"
               data-column-id="<%= column.id %>"
               data-kanban-target="column">
          <% column.list_items.reorder(:position, :created_at).each do |item| %>
            <%= render "list_items/kanban_card", item: item, list: @list, column: column %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
</div>

<!-- Subscribe to real-time header updates -->
<%= turbo_stream_from "list_#{@list.id}_header" %>
