<div class="min-h-screen bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Search Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-4">Search</h1>

      <!-- Search Input -->
      <%= form_with local: true, method: :get, url: search_path, class: "flex gap-2" do |f| %>
        <%= f.text_field :q,
            placeholder: "Search lists, items, comments, tags...",
            value: @query,
            class: "flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",
            autocomplete: "off"
        %>
        <%= f.submit "Search", class: "px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" %>
      <% end %>
    </div>

    <!-- Results Section -->
    <% if @query.present? %>
      <div class="mb-6">
        <p class="text-gray-600">
          <% if @results.any? %>
            Found <strong><%= @results.count %></strong> result<%= @results.count != 1 ? 's' : '' %>
          <% else %>
            No results found for "<%= @query %>"
          <% end %>
        </p>
      </div>

      <!-- Results List -->
      <div class="space-y-4">
        <% @results.each do |result| %>
          <div class="bg-white rounded-lg shadow hover:shadow-md transition p-6">
            <div class="flex items-start justify-between">
              <div class="flex-1">
                <!-- Result Type Badge -->
                <div class="flex items-center gap-2 mb-2">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= result_type_classes(result) %>">
                    <%= result_type_label(result) %>
                  </span>
                  <% if result.is_a?(ListItem) %>
                    <span class="text-sm text-gray-500">in <strong><%= result.list.title %></strong></span>
                  <% elsif result.is_a?(Comment) %>
                    <span class="text-sm text-gray-500">by <strong><%= result.user.name %></strong></span>
                  <% end %>
                </div>

                <!-- Result Title -->
                <h3 class="text-lg font-semibold text-gray-900 mb-1">
                  <%= extract_title(result) %>
                </h3>

                <!-- Result Description -->
                <% description = extract_description(result) %>
                <% if description.present? %>
                  <p class="text-gray-600 text-sm line-clamp-2 mb-2">
                    <%= truncate(description, length: 200) %>
                  </p>
                <% end %>

                <!-- Metadata -->
                <div class="flex items-center gap-4 text-xs text-gray-500">
                  <span>Updated <%= time_ago_in_words(result.updated_at) %> ago</span>
                  <% if result.is_a?(List) && result.is_public? %>
                    <span class="flex items-center gap-1">
                      <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 0a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm0 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-13a1 1 0 0 0-1 1v3H6a1 1 0 0 0 0 2h3v3a1 1 0 0 0 2 0v-3h3a1 1 0 0 0 0-2h-3V6a1 1 0 0 0-1-1z"></path>
                      </svg>
                      Public
                    </span>
                  <% end %>
                </div>
              </div>

              <!-- Result Action -->
              <div class="ml-4">
                <%= link_to "View", result_url(result), class: "inline-flex items-center px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded transition" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <!-- Empty State -->
      <div class="text-center py-12">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
        <h3 class="mt-4 text-lg font-medium text-gray-900">Search your content</h3>
        <p class="mt-2 text-sm text-gray-600">Enter a query above to search your lists, items, and comments</p>
      </div>
    <% end %>
  </div>
</div>

<script>
  // Auto-focus search input on load
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('input[name="q"]');
    if (searchInput) {
      searchInput.focus();
    }
  });
</script>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
